<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–µ—Ä–µ–≥–ª—è–¥ –≥–ª—ñ—Ç—á-–µ—Ñ–µ–∫—Ç—ñ–≤</title>
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; font-family: Arial, sans-serif; background: #f8f5ec; }
        .container { display: grid; grid-template-columns: 280px 1fr 280px; min-height: 100vh; gap: 10px; padding: 10px; }
        .header { grid-column: 1 / 4; background: linear-gradient(135deg, #f0c674, #eac784); padding: 20px; border-radius: 8px; }
        .header h1 { margin: 0; color: #7a4b1c; }
        .menu { grid-column: 1; background: #f9e4b7; padding: 20px; border-radius: 8px; }
        .menu ul { list-style: none; padding: 0; }
        .menu li { margin: 10px 0; }
        .menu a { display: block; padding: 10px; background: #fff; text-decoration: none; color: #7a4b1c; font-weight: bold; border-radius: 5px; }
        .menu a:hover { background: #f0c674; }
        .content { grid-column: 2; background: #2c2c2c; padding: 25px; border-radius: 8px; display: flex; align-items: center; justify-content: center; min-height: 400px; }
        #glitchDisplayArea { width: 100%; text-align: center; }
        .status-indicator { position: fixed; top: 20px; right: 20px; padding: 10px 20px; background: rgba(0, 255, 0, 0.8); color: white; border-radius: 5px; font-weight: bold; z-index: 1000; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
        .sidebar { grid-column: 3; background: #f7e1b0; padding: 20px; border-radius: 8px; }
        .update-log { background: rgba(255,255,255,0.5); padding: 10px; border-radius: 5px; margin: 10px 0; font-size: 12px; }
        .footer { grid-column: 1 / 4; background: linear-gradient(135deg, #eac784, #f0c674); padding: 15px 25px; border-radius: 8px; text-align: center; color: #7a4b1c; }
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
            .header, .menu, .content, .sidebar, .footer { grid-column: 1; }
            .status-indicator { top: 10px; right: 10px; padding: 5px 10px; font-size: 12px; }
        }
    </style>
</head>
<body>
    <div class="status-indicator" id="statusIndicator">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è...</div>

    <div class="container">
        <div class="header">
            <h1>üëÅÔ∏è –ü–µ—Ä–µ–≥–ª—è–¥ –≥–ª—ñ—Ç—á-–µ—Ñ–µ–∫—Ç—ñ–≤</h1>
        </div>

        <div class="menu">
            <h3>–ú–µ–Ω—é</h3>
            <ul>
                <li><a href="index.html">–û—Å–Ω–æ–≤–Ω–∞</a></li>
                <li><a href="editor.html">–†–µ–¥–∞–∫—Ç–æ—Ä</a></li>
                <li><a href="display.html">–ü–µ—Ä–µ–≥–ª—è–¥</a></li>
            </ul>
        </div>

        <div class="content">
            <div id="glitchDisplayArea">
                <div style="color: white; font-size: 1.5em;">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
            </div>
        </div>

        <div class="sidebar">
            <h3>‚ÑπÔ∏è –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è</h3>
            <p><strong>–ê–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è:</strong> –ö–æ–∂–Ω—ñ 3 —Å–µ–∫—É–Ω–¥–∏</p>
            <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span id="connectionStatus">–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...</span></p>
            <p><strong>–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:</strong> <span id="lastUpdate">-</span></p>
            
            <h3>üìä –ñ—É—Ä–Ω–∞–ª –æ–Ω–æ–≤–ª–µ–Ω—å</h3>
            <div id="updateLog"></div>
        </div>

        <div class="footer">
            <p>¬© 2025 –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ –∑–∞ –∑–º—ñ–Ω–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ!</p>
        </div>
    </div>

    <script>
        const displayArea = document.getElementById('glitchDisplayArea');
        const statusIndicator = document.getElementById('statusIndicator');
        const connectionStatus = document.getElementById('connectionStatus');
        const lastUpdateEl = document.getElementById('lastUpdate');
        const updateLog = document.getElementById('updateLog');
        
        let dynamicStyle = null;
        let lastDataString = "";
        let updateCount = 0;

        function addLogEntry(message) {
            updateCount++;
            const now = new Date().toLocaleTimeString('uk-UA');
            const entry = document.createElement('div');
            entry.className = 'update-log';
            entry.textContent = `[${now}] ${message}`;
            updateLog.insertBefore(entry, updateLog.firstChild);
            
            if (updateLog.children.length > 5) {
                updateLog.removeChild(updateLog.lastChild);
            }
        }

        function renderGlitch(data) {
            displayArea.innerHTML = `<div class="my-glitch" data-text="${data.text}">${data.text}</div>`;
            
            if (!dynamicStyle) {
                dynamicStyle = document.createElement('style');
                document.head.appendChild(dynamicStyle);
            }
            dynamicStyle.textContent = data.css;

            const now = new Date().toLocaleTimeString('uk-UA');
            lastUpdateEl.textContent = now;
            statusIndicator.textContent = '‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ';
            statusIndicator.style.background = 'rgba(0, 255, 0, 0.8)';
            
            addLogEntry(`–û–Ω–æ–≤–ª–µ–Ω–æ: "${data.text.substring(0, 20)}${data.text.length > 20 ? '...' : ''}"`);
        }

        async function fetchData() {
            try {
                statusIndicator.textContent = 'üîÑ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...';
                statusIndicator.style.background = 'rgba(255, 165, 0, 0.8)';
                
                const response = await fetch(`api.php?_=${new Date().getTime()}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const data = await response.json();
                
                const currentDataString = JSON.stringify(data);
                if (currentDataString !== lastDataString) {
                    console.log('–í–∏—è–≤–ª–µ–Ω–æ –∑–º—ñ–Ω–∏:', data);
                    renderGlitch(data);
                    lastDataString = currentDataString;
                } else {
                    statusIndicator.textContent = '‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ';
                    statusIndicator.style.background = 'rgba(0, 255, 0, 0.8)';
                }
                
                connectionStatus.textContent = 'üü¢ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ';
                
            } catch (error) {
                console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è:', error);
                connectionStatus.textContent = 'üî¥ –ü–æ–º–∏–ª–∫–∞ –∑\'—î–¥–Ω–∞–Ω–Ω—è';
                statusIndicator.textContent = '‚ùå –ü–æ–º–∏–ª–∫–∞';
                statusIndicator.style.background = 'rgba(255, 0, 0, 0.8)';
                addLogEntry('‚ö†Ô∏è –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö');
            }
        }

        fetchData();
        setInterval(fetchData, 3000);

        addLogEntry('üöÄ –°—Ç–æ—Ä—ñ–Ω–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞');
    </script>
</body>
</html>
